<p>
    <a class="btn btn-primary" data-toggle="collapse" href="#AddRace" role="button" aria-expanded="false" aria-controls="AddRace">
        Add race
    </a>
</p>
<div class="collapse" id="AddRace">
    <form *ngIf="addRaceForm" [formGroup]="addRaceForm" (submit)="addRaceClick(addRaceNgForm)" #addRaceNgForm="ngForm"
        role="form">
        <div class="row">
            <div class="col">
                <div class="form-group" [ngClass]="{'has-error': (addRaceForm.get('name').touched || addRaceForm.get('name').dirty) &&
                        !addRaceForm.get('name').valid }">
                    <label class="control-label" for="raceName">Name</label>
                    <input class="form-control" id="raceName" type="text" placeholder="Name (required)" formControlName="name" />
                    <span class="help-block" *ngIf="(addRaceForm.get('name').touched || addRaceForm.get('name').dirty) && 
                            addRaceForm.get('name').errors">
                        <span *ngIf="addRaceForm.get('name').errors.required">
                            Please enter a name.
                        </span>
                    </span>
                </div>

                <div class="form-group" [ngClass]="{'has-error': (addRaceForm.get('checkCoordinates').touched || addRaceForm.get('checkCoordinates').dirty) &&
                    !addRaceForm.get('checkCoordinates').valid }">
                    <div class="checkbox">
                        <label>
                            <input id="checkCoordinates" type="checkbox" formControlName="checkCoordinates">
                            Check GPS coordinates
                            <span class="help-block" *ngIf="(addRaceForm.get('checkCoordinates').touched || addRaceForm.get('checkCoordinates').dirty) && 
                            addRaceForm.get('checkCoordinates').errors">
                                <span *ngIf="addRaceForm.get('checkCoordinates').errors.required">
                                    Please enter check coordinates checkbox.
                                </span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="form-group" [ngClass]="{'has-error': (addRaceForm.get('specialTasksAreStage').touched || addRaceForm.get('specialTasksAreStage').dirty) &&
                    !addRaceForm.get('specialTasksAreStage').valid }">
                    <div class="checkbox">
                        <label>
                            <input id="specialTasksAreStage" type="checkbox" formControlName="specialTasksAreStage">
                            Special tasks are a stage
                            <span class="help-block" *ngIf="(addRaceForm.get('checkCoordinates').touched || addRaceForm.get('checkCoordinates').dirty) && 
                                addRaceForm.get('checkCoordinates').errors">
                                <span *ngIf="addRaceForm.get('checkCoordinates').errors.required">
                                    Please enter check coordinates checkbox.
                                </span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="form-group" [ngClass]="{'has-error': (addRaceForm.get('maximumTeamSize').touched || addRaceForm.get('maximumTeamSize').dirty) &&
                        !addRaceForm.get('maximumTeamSize').valid }">
                    <label class="control-label" for="maximumTeamSize">Maximum team size</label>
                    <input class="form-control" id="maximumTeamSize" type="text" placeholder="1 (required)"
                        formControlName="maximumTeamSize" />
                    <span class="help-block" *ngIf="(addRaceForm.get('maximumTeamSize').touched || addRaceForm.get('maximumTeamSize').dirty) && 
                            addRaceForm.get('maximumTeamSize').errors">
                        <span *ngIf="addRaceForm.get('maximumTeamSize').errors.required">
                            Please enter the maximum team size.
                        </span>
                    </span>
                </div>

                <div class="form-group" [ngClass]="{'has-error': (addRaceForm.get('minimumPointsToCompleteStage').touched || addRaceForm.get('minimumPointsToCompleteStage').dirty) &&
                        !addRaceForm.get('minimumPointsToCompleteStage').valid }">
                    <label class="control-label" for="minimumPointsToCompleteStage">Minimum points to complete a stage</label>
                    <input class="form-control" id="minimumPointsToCompleteStage" type="text" placeholder="1 (required)"
                        formControlName="minimumPointsToCompleteStage" />
                    <span class="help-block" *ngIf="(addRaceForm.get('minimumPointsToCompleteStage').touched || addRaceForm.get('minimumPointsToCompleteStage').dirty) && 
                            addRaceForm.get('minimumPointsToCompleteStage').errors">
                        <span *ngIf="addRaceForm.get('minimumPointsToCompleteStage').errors.required">
                            Please enter the minimum points needed to complate a stage.
                        </span>
                    </span>
                </div>
            </div>

            <div class="col">
                <div class="form-group" [ngClass]="{'has-error': (addRaceForm.get('startDate').touched || addRaceForm.get('startDate').dirty) &&
                        !addRaceForm.get('startDate').valid }">
                    <label class="control-label" for="startDate">Start date</label>
                    <input class="form-control" id="startDate" type="text" placeholder="dd-mm-yyyy" formControlName="startDate" />
                    <span class="help-block" *ngIf="(addRaceForm.get('startDate').touched || addRaceForm.get('startDate').dirty) && 
                            addRaceForm.get('startDate').errors">
                    </span>
                </div>

                <div class="form-group" [ngClass]="{'has-error': (addRaceForm.get('startTime').touched || addRaceForm.get('startTime').dirty) &&
                        !addRaceForm.get('startTime').valid }">
                    <label class="control-label" for="startTime">Start time</label>
                    <input class="form-control" id="startTime" type="text" placeholder="hh:mm" formControlName="startTime" />
                    <span class="help-block" *ngIf="(addRaceForm.get('startTime').touched || addRaceForm.get('startTime').dirty) && 
                            addRaceForm.get('startTime').errors">
                    </span>
                </div>

                <div class="form-group" [ngClass]="{'has-error': (addRaceForm.get('endDate').touched || addRaceForm.get('endDate').dirty) &&
                        !addRaceForm.get('endDate').valid }">
                    <label class="control-label" for="endDate">End date</label>
                    <input class="form-control" id="endDate" type="text" placeholder="dd-mm-yyyy" formControlName="endDate" />
                    <span class="help-block" *ngIf="(addRaceForm.get('endDate').touched || addRaceForm.get('endDate').dirty) && 
                            addRaceForm.get('endDate').errors">
                    </span>
                </div>

                <div class="form-group" [ngClass]="{'has-error': (addRaceForm.get('endTime').touched || addRaceForm.get('endTime').dirty) &&
                        !addRaceForm.get('endTime').valid }">
                    <label class="control-label" for="endTime">End time</label>
                    <input class="form-control" id="endTime" type="text" placeholder="hh:mm" formControlName="endTime" />
                    <span class="help-block" *ngIf="(addRaceForm.get('endTime').touched || addRaceForm.get('endTime').dirty) && 
                            addRaceForm.get('endTime').errors">
                    </span>
                </div>
            </div>
        </div>
        <div *ngIf="(addBase$ | async).error">
            <div *ngIf="(addBase$ | async).error.json() === 0">
                A race with name '{{this.addRaceForm.get('name').value}}' already exists
            </div>
        </div>

        <button type="submit" [disabled]="(addBase$ | async).isActive">Add race</button>
    </form>
    <div *ngIf="(addBase$ | async).isActive">
        Adding race.
    </div>
</div>